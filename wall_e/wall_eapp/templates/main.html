<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Insert title here</title>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <style>
    img{
      width:350px;
      height:350px;
      object-fit: contain;
    }
    body{
      background-color:bisque;
    }
    #mainDiv{
      width:700px;
      height:700px;
      margin:auto;
      margin-top:100px;
      background-color: white;
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="mainDiv">
    <button id="selectImg">사진선택</button>
    <br>
    <img id="preview" style="display:none">
    <br>
    <button id="submit_btn" style="display:none">go</button>
    <form id="imgForm" enctype="multipart/form-data" method="post" style="display: none">
      {% csrf_token %}
      <input type="file" accept=".jpg, .jpeg, .png, .JPG, .JPEG, .gif" name="img" id="img" onchange="readURL(this);">
    </form>
    
  </div>
  <script>
    $.ajaxSetup({
      headers: { "X-CSRFToken": '{{csrf_token}}' }
    });
    $("#submit_btn").click(function (e) {
      e.preventDefault();
      var form = $("#imgForm")[0];
      var imgData = new FormData(form);
      imgData.append("img", $("#imgForm")[0][0]);
      $.ajax({
        url: "/classify/",
        type: "POST",
        contentType: false,               // * 중요 *
        processData: false,               // * 중요 *
        enctype: 'multipart/form-data',  // * 중요 *
        data: imgData,
        success: function (data) {
          console.log(data);
        }
      })

    })
    function readURL(input) {
      if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {
          document.getElementById('preview').src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
      } else {
        document.getElementById('preview').src = "";
      }
      $("#preview").removeAttr("style");
      $("#submit_btn").removeAttr("style");
    }
    $("#selectImg").click(function(e){
      $("#img").click();
    })


  </script>
  </body>
  
  </html>